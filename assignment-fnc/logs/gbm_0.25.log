Namespace(model='gbm', skip_preprocess=False, train_prop='0.25')
Reading data..
Original data sizes
1683

Training the dataset with only 25.0% of the training set
Train shape : (12493, 4)
Test shape : (25413, 4)

Fitting a tfidf vectorizer..
Tfidf vectorized train_words shape: (12493, 28385)
Tfidf vectorized test_words shape: (25413, 28385)

Train set processing...
Reducing dimensions of bag of words...
Explained variance of SVD on features: 63%
Calculating refutes...
Calculating overlaps...
Feature shape (12493, 202)

Test set processing...
Reducing dimensions of bag of words...
Explained variance of SVD on features: 75%
Calculating refutes...
Calculating overlaps...
Feature shape (25413, 202)


Training a gbm model

Training time took 93.14040064811707 seconds

Trained a model using GradientBoostingClassifier(criterion='friedman_mse', init=None,
              learning_rate=0.1, loss='deviance', max_depth=3,
              max_features=None, max_leaf_nodes=None,
              min_impurity_decrease=0.0, min_impurity_split=None,
              min_samples_leaf=1, min_samples_split=2,
              min_weight_fraction_leaf=0.0, n_estimators=100,
              n_iter_no_change=None, presort='auto', random_state=None,
              subsample=1.0, tol=0.0001, validation_fraction=0.1,
              verbose=0, warm_start=False)
Training FNC Score:
-------------------------------------------------------------
|           |   agree   | disagree  |  discuss  | unrelated |
-------------------------------------------------------------
|   agree   |    504    |    19     |    191    |    212    |
-------------------------------------------------------------
| disagree  |    29     |    90     |    50     |    50     |
-------------------------------------------------------------
|  discuss  |    62     |     5     |   1728    |    399    |
-------------------------------------------------------------
| unrelated |    48     |     4     |    230    |   8872    |
-------------------------------------------------------------
Score: 4629.0 out of 5627.5	(82.25677476677032%)
Train F1 Score: 0.7282038206392772

Test FNC Score:
-------------------------------------------------------------
|           |   agree   | disagree  |  discuss  | unrelated |
-------------------------------------------------------------
|   agree   |    74     |    16     |   1338    |    475    |
-------------------------------------------------------------
| disagree  |     9     |    13     |    351    |    324    |
-------------------------------------------------------------
|  discuss  |    209    |    49     |   3203    |   1003    |
-------------------------------------------------------------
| unrelated |    158    |    146    |   1358    |   16687   |
-------------------------------------------------------------
Score: 7954.75 out of 11651.25	(68.27379036584057%)
Test F1 Score: 0.39875113863974115
